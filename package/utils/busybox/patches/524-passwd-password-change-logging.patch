Index: busybox-1.34.1/loginutils/passwd.c
===================================================================
--- busybox-1.34.1.orig/loginutils/passwd.c
+++ busybox-1.34.1/loginutils/passwd.c
@@ -40,6 +40,20 @@
 #include "libbb.h"
 #include <syslog.h>
 
+#ifdef CONFIG_PASSWD
+#include <tlt_logger.h>
+
+void log_event(char *user) {
+	char cmd[1024];
+
+	cmd[0] = '\0';
+	sprintf(cmd, "password has been changed for user %s", user);
+
+	log_db("Passwd", LOG_SYSTEM, L_NOTICE, "%s", cmd);
+
+}
+#endif // CONFIG_PASSWD
+
 static char* new_password(const struct passwd *pw, uid_t myuid, const char *algo)
 {
 	char salt[MAX_PW_SALT_LEN];
@@ -232,7 +246,11 @@ int passwd_main(int argc UNUSED_PARAM, c
 	/* LOGMODE_BOTH */
 	if (rc < 0)
 		bb_error_msg_and_die("can't update password file %s", filename);
+#ifndef CONFIG_PASSWD
 	bb_info_msg("password for %s changed by %s", name, myname);
+#else
+	log_event(name);
+#endif // CONFIG_PASSWD
 
 	/*if (ENABLE_FEATURE_CLEAN_UP) free(newp); - can't, it may be non-malloced */
  skip:
Index: busybox-1.34.1/Makefile
===================================================================
--- busybox-1.34.1.orig/Makefile
+++ busybox-1.34.1/Makefile
@@ -572,6 +572,10 @@ libs-y1		:= $(patsubst %/, %/lib.a, $(li
 libs-y2		:= $(patsubst %/, %/built-in.o, $(libs-y))
 libs-y		:= $(libs-y1) $(libs-y2)
 
+ifdef CONFIG_PASSWD
+CONFIG_EXTRA_LDLIBS:=ubus tlt_logger
+endif
+
 # Build busybox
 # ---------------------------------------------------------------------------
 # busybox is build from the objects selected by $(busybox-init) and
