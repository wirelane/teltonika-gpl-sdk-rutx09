(function(o,d){typeof exports=="object"&&typeof module<"u"?module.exports=d():typeof define=="function"&&define.amd?define(d):(o=typeof globalThis<"u"?globalThis:o||self,o["services/AzureIotHub_js"]=d())})(this,function(){"use strict";function o(i,e,s,u,t,c,l,_){var n=typeof i=="function"?i.options:i;e&&(n.render=e,n.staticRenderFns=s,n._compiled=!0),u&&(n.functional=!0),c&&(n._scopeId="data-v-"+c);var a;if(l?(a=function(r){r=r||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!r&&typeof __VUE_SSR_CONTEXT__<"u"&&(r=__VUE_SSR_CONTEXT__),t&&t.call(this,r),r&&r._registeredComponents&&r._registeredComponents.add(l)},n._ssrRegister=a):t&&(a=_?function(){t.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:t),a)if(n.functional){n._injectStyles=a;var b=n.render;n.render=function(g,p){return a.call(p),b(g,p)}}else{var m=n.beforeCreate;n.beforeCreate=m?[].concat(m,a):[a]}return{exports:i,options:n}}const d={data(){return{modemList:[],msgTypes:[["mqtt",this.$t("MQTT messages")],["gsmctl",this.$t("GSM values")]],interfaces:[],isPasswordSet:!1,passSetPlaceholder:this.$t("Password is set")}},computed:{gsmValues(){const i=[["cellid",this.$t("Cell ID")],["connstate",this.$t("Connection state")],["conntype",this.$t("Data carrier type")],["ecio",this.$t("ECIO")],["iccid",this.$t("ICCID")],["imei",this.$t("IMEI")],["imsi",this.$t("IMSI")],["ipaddr",this.$t("IP Address")],["manuf",this.$t("Manufacturer")],["model",this.$t("Model")],["netstate",this.$t("Network link state")],["operator",this.$t("Operator")],["opernum",this.$t("Operator number")],["pincount",this.$t("PIN count")],["pinstate",this.$t("PIN state")],["revision",this.$t("Revision number")],["rscp",this.$t("RSCP")],["rsrp",this.$t("RSRP")],["rsrq",this.$t("RSRQ")],["serial",this.$t("Serial number")],["signal",this.$t("Signal level")],["simstate",this.$t("SIM card state")],["sinr",this.$t("SINR")],["temp",this.$t("Temperature")]];return this.$store.getters.hasPackages("mdcollectd.control")&&i.unshift(["brecv",this.$t("Bytes received")],["bsent",this.$t("Bytes sent")]),i}},methods:{loadData(i){const e=[{endpoint:"/api/modems/status",condition:"mobifd.control"},"/api/interfaces/config"];return this.$axios.bulkGet(e).then(s=>(this.parseModemsData(s[0].success?s[0].data:[]),this.parseInterfacesData(s[1].success?s[1].data:[]),s[0].success||this.$message.error(this.$t("Failed to load modem data")),s[1].success||this.$message.error(this.$t("Failed to load interface data")),this.isPasswordSet=i.azure_iothub[0].mqtt_password==="set",this.$set(i.azure_iothub[0],"mqtt_password",""),i)).catch(()=>{this.$message.error(this.$t("An unexpected error occurred"))})},onAfterSave(i,e){this.isPasswordSet=e.data.mqtt_password==="set",e.data.mqtt_password="",this.$set(e.data,"require_password",this.isPasswordSet?"1":"0")},parseModemsData(i){this.modemList=this.$mobile.parseModems(i),this.modemList.length===0&&this.msgTypes.pop()},parseInterfacesData(i){this.interfaces=i.filter(e=>(e.proto==="wwan"||e.proto==="connm")&&e.modem!=="undefined").map(this.$network.getName),this.interfaces.length<1&&this.interfaces.push(["",this.$t("No modem connected")])},dependOnType(i,e){return i.msg_type===e}}};var h=function(){var e=this,s=e._self._c;return s("vuci-form",{attrs:{config:"azure_iothub","after-load":e.loadData},scopedSlots:e._u([{key:"default",fn:function({uciData:u}){return[s("vuci-named-section",{attrs:{"uci-data":u,title:e.$t("Azure IoT Hub"),endpoints:[{endpoint:"azure_iot_hub/config",sectionFilter:t=>t[0]}],"data-key":"azure_iothub","after-save":e.onAfterSave},scopedSlots:e._u([{key:"default",fn:function({s:t}){return[s("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Enable Azure IoT Hub monitoring"),name:"enabled"}}),s("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Connection String"),name:"connection_string",rules:"string",required:t.enabled==="1"}}),s("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Messages Type"),name:"msg_type",options:e.msgTypes}}),s("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("MQTT Host"),name:"mqtt_ip",help:e.$t("Host address of MQTT broker"),rules:"host",depend:e.dependOnType(t,"mqtt"),required:t.enabled==="1"}}),s("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("MQTT Port"),name:"mqtt_port",help:e.$t("Port of MQTT broker"),rules:"port",depend:e.dependOnType(t,"mqtt"),required:t.enabled==="1"}}),s("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Topic"),name:"mqtt_topic",help:e.$t("Topic to subscribe"),rules:"string",maxlength:"64",depend:e.dependOnType(t,"mqtt"),required:t.enabled==="1"}}),s("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Username"),name:"mqtt_username",depend:e.dependOnType(t,"mqtt"),maxlength:"512"}}),s("vuci-form-item-switch",{attrs:{name:"require_password","uci-section":t,label:e.$t("Require password"),initial:e.isPasswordSet?"1":"0",depend:e.dependOnType(t,"mqtt"),"no-write":""}}),s("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Password"),name:"mqtt_password",depend:e.dependOnType(t,"mqtt")&&t.require_password==="1",rules:"string",maxlength:"512",required:!e.isPasswordSet&&t.require_password==="1","no-write":t.mqtt_password===""&&t.require_password==="1",placeholder:e.isPasswordSet?e.passSetPlaceholder:"",password:""}}),s("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Message sending interval (sec.)"),name:"message_interval",depend:e.dependOnType(t,"gsmctl"),initial:"300",rules:"range(10,99999)",required:t.enabled==="1"}}),s("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Mobile Interface"),name:"interface",options:e.interfaces,depend:e.dependOnType(t,"gsmctl")&&e.modemList.length>0}}),s("vuci-form-item-select",{attrs:{"uci-section":t,name:"gsm",label:e.$t("GSM Values"),placeholder:e.$t("-- Please choose --"),options:e.gsmValues,depend:e.dependOnType(t,"gsmctl"),multiple:"",required:t.enabled==="1"}})]}}],null,!0)})]}}])})},f=[],$=o(d,h,f,!1,null,null,null,null);return $.exports});
