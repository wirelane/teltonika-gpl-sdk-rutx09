(function(c,u){typeof exports=="object"&&typeof module<"u"?module.exports=u():typeof define=="function"&&define.amd?define(u):(c=typeof globalThis<"u"?globalThis:c||self,c["services/Upnp_js"]=u())})(this,function(){"use strict";function c(n,e,i,a,t,d,s,v){var r=typeof n=="function"?n.options:n;e&&(r.render=e,r.staticRenderFns=i,r._compiled=!0),a&&(r.functional=!0),d&&(r._scopeId="data-v-"+d);var l;if(s?(l=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),t&&t.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(s)},r._ssrRegister=l):t&&(l=v?function(){t.call(this,(r.functional?this.parent:this).$root.$options.shadowRoot)}:t),l)if(r.functional){r._injectStyles=l;var _=r.render;r.render=function(b,m){return l.call(m),_(b,m)}}else{var p=r.beforeCreate;r.beforeCreate=p?[].concat(p,l):[l]}return{exports:n,options:r}}const u={data(){return{actions:[["allow",this.$t("Allow")],["deny",this.$t("Deny")]],redirectColumns:[{dataIndex:"proto",title:this.$t("Protocol")},{dataIndex:"extport",title:this.$t("External port")},{dataIndex:"intaddr",title:this.$t("Client address")},{dataIndex:"intport",title:this.$t("Client port")},{dataIndex:"remove",title:""}],aclColumns:[{name:"comment",label:this.$t("Comment"),help:this.$t("Adds a comment to this rule")},{name:"ext_ports",label:this.$t("External ports"),help:this.$t("External port(s) which may be redirected. May be specified as a single port or a range of ports")},{name:"int_addr",label:this.$t("Internal addresses"),help:this.$t("Internal address to be redirect to")},{name:"int_ports",label:this.$t("Internal ports"),help:this.$t("Internal port(s) to be redirect to. May be specified as a single port or a range of ports")},{name:"action",label:this.$t("Action"),help:this.$t("Allows or forbids the UPnP service to open the specified port")}],tabs:[{tab:"general",title:this.$t("General settings")},{tab:"advanced",title:this.$t("Advanced settings")}],redirectsData:[]}},timers:{loadRedirectData:{time:4e3,autostart:!0,repeat:!0}},methods:{returnErrorMessage(n){const e=n.data.errors.some(s=>s.code===1),i=n.data.errors.some(s=>s.code===2),a=n.data.errors.some(s=>s.code===3),t=n.data.errors.some(s=>s.code===4),d=n.data.errors.some(s=>s.code===5);return e?this.$t("Provided UPNP lease file path is a directory."):i?this.$t("Unable to read UPNP lease file."):a?this.$t("File selected as UPNP lease file is already in use."):t?this.$t('Provided UPNP lease file path is invalid, must start with "/" and must exist.'):d?this.$t("UPNP lease file path must not contain a space."):this.$t("An unexpected error occurred")},loadRedirectData(){return this.$axios.get("/api/upnp/redirects/config").then(({data:n})=>{this.redirectsData=n}).catch(()=>{this.$message.error(this.$t("Failed to load upnp redirects"))})},removeRedirect(n){this.$spin();const e=[{endpoint:`/api/upnp/redirects/config/${n}`,method:"DELETE"},{endpoint:"/api/upnp/redirects/config",method:"GET"}];return this.$axios.bulk(e).then(([i,a])=>{i.success?this.$message.success("Upnp redirect removed successfully"):this.$message.error(this.$t("Failed to remove upnp redirect")),a.success?this.redirectsData=a.data:this.$message.error(this.$t("Failed to load upnp redirects"))}).catch(()=>{this.$message.error(this.$t("Unexpected error occurred"))}).finally(()=>{this.$spin(!1)})}}};var f=function(){var e=this,i=e._self._c;return i("vuci-form",{attrs:{config:"upnpd","after-load":e.loadRedirectData},scopedSlots:e._u([{key:"default",fn:function({uciData:a}){return[i("tlt-card",{attrs:{title:e.$t("Active UPnP Redirects"),help:e.$t("UPnP allows clients in the local network to automatically configure the router")}},[i("tlt-table",{attrs:{id:"upnp_redirects","data-source":e.redirectsData,columns:e.redirectColumns},scopedSlots:e._u([{key:"remove",fn:function({record:t}){return[i("tlt-button",{attrs:{"button-id":"remove",size:"sm"},on:{click:function(d){return e.removeRedirect(t.num)}}},[e._v(" "+e._s(e.$t("Remove"))+" ")])]}}],null,!0)})],1),i("vuci-named-section",{attrs:{title:e.$t("MiniUPnP Settings"),help:e.$t("Here you can configure UPnP settings"),endpoints:[{endpoint:"upnp/global"}],"uci-data":a,"data-key":"upnpd","error-handlers":{edit:e.returnErrorMessage},name:"general"},scopedSlots:e._u([{key:"default",fn:function({s:t}){return[i("tlt-tabs",{attrs:{tabs:e.tabs},scopedSlots:e._u([{key:"general",fn:function(){return[i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Enable"),name:"enabled",help:e.$t("Toggles UPnP ON or OFF"),rmempty:!1}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Enable secure mode"),name:"secure_mode",help:e.$t("Allow adding forwards only to requesting ip addresses")}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Enable additional logging"),name:"log_output",help:e.$t("Puts extra debugging information into the system log")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Downlink"),name:"download",placeholder:"1024",rules:"uinteger",help:e.$t("Value in KByte/s, informational only")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Uplink"),name:"upload",placeholder:"512",rules:"uinteger",help:e.$t("Value in KByte/s, informational only")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Port"),name:"port",rules:"port",placeholder:"5000",help:e.$t("Specifies UPnP port")}})]},proxy:!0},{key:"advanced",fn:function(){return[i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Report system instead of daemon uptime"),name:"system_uptime",help:e.$t("Choose if system or MINIUPNP service uptime is reported"),initial:"1"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Device UUID"),name:"uuid",placeholder:"2c1b66d8-a205-11e9-a2a3-2a2ae2dbcce4",rules:"fieldvalidation('^[a-zA-Z0-9_-]+$')",help:e.$t("Specify Universal unique ID of the device")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Announced serial number"),name:"serial_number",placeholder:"12345678",help:e.$t("Specifies serial number for XML Root Desc.")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Announced model number"),name:"model_number",placeholder:"12345",help:e.$t("Specifies model number for XML Root Desc.")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Notify interval"),name:"notify_interval",rules:"uinteger",placeholder:"30",help:e.$t("Interval in which UPnP capable devices send a message to announce their services")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Clean rules threshold"),name:"clean_ruleset_threshold",rules:"uinteger",placeholder:"20",help:e.$t("Minimum number of redirections before clearing rules table of old (active) redirections")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Clean rules interval"),rules:"uinteger",name:"clean_ruleset_interval",placeholder:"600",help:e.$t("Number of seconds before cleaning redirections")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Presentation URL"),name:"presentation_url",placeholder:"http://192.168.1.1/",rules:"host",help:e.$t("Presentation url used for the Root Desc.")}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("UPnP lease file"),name:"upnp_lease_file",placeholder:"/var/log/upnp.leases",rules:"string",help:e.$t("Stores active UPnP redirects in a lease file (specified), like DHCP leases")}})]},proxy:!0}],null,!0)})]}}],null,!0)}),i("vuci-typed-section",{attrs:{type:"perm_rule","data-key":"perm_rule",title:e.$t("MiniUPnP ACLs"),help:e.$t("ACLs specify which external ports may be redirected to which internal addresses and ports"),endpoints:[{endpoint:"upnp/acls/config"}],"uci-data":a,columns:e.aclColumns,addremove:""},scopedSlots:e._u([{key:"comment",fn:function({s:t}){return[i("vuci-form-item-input",{attrs:{"uci-section":t,name:"comment",rules:"fieldvalidation('^[a-zA-Z0-9_ ]+$')",placeholder:e.$t("Comment")}})]}},{key:"ext_ports",fn:function({s:t}){return[i("vuci-form-item-input",{attrs:{"uci-section":t,name:"ext_ports",rules:"portrange",placeholder:"1-65535"}})]}},{key:"int_addr",fn:function({s:t}){return[i("vuci-form-item-input",{attrs:{"uci-section":t,name:"int_addr",rules:"ipmask4",placeholder:"0.0.0.0/0"}})]}},{key:"int_ports",fn:function({s:t}){return[i("vuci-form-item-input",{attrs:{"uci-section":t,name:"int_ports",rules:"portrange",placeholder:"1-65535"}})]}},{key:"action",fn:function({s:t}){return[i("vuci-form-item-select",{attrs:{"uci-section":t,name:"action",options:e.actions}})]}}],null,!0)})]}}])})},h=[],$=c(u,f,h,!1,null,null,null,null);return $.exports});
