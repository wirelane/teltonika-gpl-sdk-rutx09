{
  "openapi": "3.0.0",
  "tags": [],
  "paths": {
    "/cloud_solutions/azure_iothub/config/general": {
      "get": {
        "tags": ["Azure IoT Hub"],
        "summary": "Returns Azure IoT Hub configuration",
        "responses": {
          "200": {
            "$ref": "#/components/responses/200Azure"
          }
        }
      },
      "put": {
        "tags": ["Azure IoT Hub"],
        "summary": "Updates Azure IoT Hub configuration",
        "responses": {
          "200": {
            "$ref": "#/components/responses/200Azure"
          },
          "422": {
            "$ref": "#/components/responses/422response"
          }
        },
        "requestBody": {
          "description": "Configuration options",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "data": {
                    "$ref": "#/components/schemas/azure_iothub_single_options"
                  }
                }
              }
            }
          }
        }
      },
      "x-web": {
        "menu": ["Services", "Cloud Solutions", "Azure IoT Hub"],
        "hw_tags": {
          "is_access_point": false,
          "is_switch": false
        }
      }
    },
    "/cloud_solutions/azure_iothub/config": {
      "get": {
        "tags": ["Azure IoT Hub"],
        "summary": "Returns Azure IoT Hub configuration in an array",
        "responses": {
          "200": {
            "$ref": "#/components/responses/200AzureMulti"
          }
        }
      },
      "x-web": {
        "menu": ["Services", "Cloud Solutions", "Azure IoT Hub"],
        "hw_tags": {
          "is_access_point": false,
          "is_switch": false
        }
      },
      "put": {
        "tags": ["Azure IoT Hub"],
        "summary": "Updates Azure IoT Hub configuration in an array",
        "responses": {
          "200": {
            "$ref": "#/components/responses/200AzureMulti"
          },
          "404": {
            "$ref": "#/components/responses/404response"
          },
          "422": {
            "$ref": "#/components/responses/422response"
          }
        },
        "requestBody": {
          "description": "Configuration options",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "data": {
                    "type": "array",
                    "description": "Array of configuration options objects",
                    "items": {
                      "$ref": "#/components/schemas/azure_iothub_options"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "responses": {
      "200Azure": {
        "description": "Returns configuration",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean",
                  "description": "Operation status"
                },
                "data": {
                  "$ref": "#/components/schemas/azure_iothub_options"
                }
              }
            }
          }
        }
      },
      "200AzureMulti": {
        "description": "Returns configurations",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean",
                  "description": "Operation status"
                },
                "data": {
                  "type": "array",
                  "description": "Array of configuration objects",
                  "items": {
                    "$ref": "#/components/schemas/azure_iothub_options"
                  }
                }
              }
            }
          }
        }
      }
    },
    "schemas": {
      "azure_iothub_single_options": {
        "type": "object",
        "properties": {
          "enabled": {
            "description": "Enable Azure IoT Hub monitoring",
            "type": "string",
            "enum": ["0", "1"],
            "x-web": {
              "pretty": "Enable Azure IoT Hub monitoring",
              "input-type": "switch"
            }
          },
          "connection_string": {
            "type": "string",
            "format": "string",
            "description": "Connection String",
            "x-web": {
              "pretty": "Connection String",
              "input-type": "input"
            }
          },
          "msg_type": {
            "type": "string",
            "description": "Messages Type",
            "enum": ["mqtt"],
            "x-web": {
              "pretty": "Messages Type",
              "input-type": "select",
              "enum-pretty": {
                "mqtt": "MQTT messages",
                "gsmctl": "GSM values"
              },
              "enum-depends": [
                {
                  "hw_tags": {
                    "mobile": true
                  },
                  "values": ["mqtt", "gsmctl"]
                }
              ]
            }
          },
          "mqtt_ip": {
            "type": "string",
            "format": "host",
            "description": "Host address of MQTT broker",
            "x-web": {
              "pretty": "MQTT Host",
              "input-type": "input",
              "depends": [
                {
                  "msg_type": "mqtt"
                }
              ]
            }
          },
          "mqtt_port": {
            "type": "string",
            "description": "Port of MQTT broker",
            "format": "port",
            "x-web": {
              "pretty": "MQTT Port",
              "input-type": "input",
              "depends": [
                {
                  "msg_type": "mqtt"
                }
              ]
            }
          },
          "mqtt_topic": {
            "type": "string",
            "description": "Topic to subscribe",
            "format": "string",
            "maxLength": 64,
            "x-web": {
              "pretty": "Topic",
              "input-type": "input",
              "depends": [
                {
                  "msg_type": "mqtt"
                }
              ]
            }
          },
          "mqtt_username": {
            "type": "string",
            "description": "Username",
            "maxLength": 512,
            "x-web": {
              "pretty": "Username",
              "input-type": "input",
              "depends": [
                {
                  "msg_type": "mqtt"
                }
              ]
            }
          },
          "mqtt_password": {
            "type": "string",
            "description": "Password",
            "format": "string",
            "maxLength": 512,
            "writeOnly": true,
            "x-web": {
              "pretty": "Password",
              "input-type": "input",
              "depends": [
                {
                  "msg_type": "mqtt"
                }
              ]
            }
          },
          "message_interval": {
            "description": "Message sending interval (sec.)",
            "type": "string",
            "format": "irange(10,99999)",
            "default": "300",
            "x-web": {
              "pretty": "Message sending interval (sec.)",
              "input-type": "input",
              "depends": [
                {
                  "msg_type": "gsmctl"
                }
              ]
            }
          },
          "interface": {
            "type": "string",
            "description": "Mobile Interface",
            "x-web": {
              "pretty": "Mobile Interface",
              "input-type": "input",
              "depends": [
                {
                  "msg_type": "gsmctl"
                }
              ]
            }
          },
          "gsm": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "brecv",
                "bsent",
                "cellid",
                "pincount",
                "pinstate",
                "revision",
                "rscp",
                "rsrp",
                "rsrq",
                "serial",
                "signal",
                "simstate",
                "sinr",
                "connstate",
                "conntype",
                "ecio",
                "iccid",
                "imei",
                "imsi",
                "ipaddr",
                "manuf",
                "model",
                "netstate",
                "operator",
                "opernum",
                "temp"
              ]
            },
            "x-web": {
              "pretty": "GSM Values",
              "input-type": "multiselect",
              "depends": [
                {
                  "msg_type": "gsmctl"
                }
              ],
              "enum-pretty": {
                "brecv": "Bytes received",
                "bsent": "Bytes sent",
                "cellid": "Cell ID",
                "connstate": "Connection state",
                "conntype": "Data carrier type",
                "ecio": "ECIO",
                "iccid": "ICCID",
                "imei": "IMEI",
                "imsi": "IMSI",
                "ipaddr": "IP Address",
                "manuf": "Manufacturer",
                "model": "Model",
                "netstate": "Network link state",
                "operator": "Operator",
                "opernum": "Operator number",
                "pincount": "PIN count",
                "pinstate": "PIN state",
                "revision": "Revision number",
                "rscp": "RSCP",
                "rsrp": "RSRP",
                "rsrq": "RSRQ",
                "serial": "Serial number",
                "signal": "Signal level",
                "simstate": "SIM card state",
                "sinr": "SINR",
                "temp": "Temperature"
              },
              "enum-depends": [
                {
                  "hw_tags": {
                    "is_trb500": true
                  },
                  "values": [
                    "cellid",
                    "pincount",
                    "pinstate",
                    "revision",
                    "rscp",
                    "rsrp",
                    "rsrq",
                    "serial",
                    "signal",
                    "simstate",
                    "sinr",
                    "connstate",
                    "conntype",
                    "ecio",
                    "iccid",
                    "imei",
                    "imsi",
                    "ipaddr",
                    "manuf",
                    "model",
                    "netstate",
                    "operator",
                    "opernum",
                    "temp"
                  ]
                }
              ]
            }
          }
        },
        "required": ["connection_string", "mqtt_ip", "mqtt_port", "mqtt_topic", "message_interval"]
      },
      "azure_iothub_options": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "description": "Configuration ID"
              }
            }
          },
          {
            "$ref": "#/components/schemas/azure_iothub_single_options"
          }
        ]
      }
    }
  }
}
