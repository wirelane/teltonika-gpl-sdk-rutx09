(function(d,m){typeof exports=="object"&&typeof module<"u"?module.exports=m():typeof define=="function"&&define.amd?define(m):(d=typeof globalThis<"u"?globalThis:d||self,d["services/EmailRelay_js"]=m())})(this,function(){"use strict";function d(a,e,i,o,n,t,c,S){var r=typeof a=="function"?a.options:a;e&&(r.render=e,r.staticRenderFns=i,r._compiled=!0),o&&(r.functional=!0),t&&(r._scopeId="data-v-"+t);var s;if(c?(s=function(l){l=l||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!l&&typeof __VUE_SSR_CONTEXT__<"u"&&(l=__VUE_SSR_CONTEXT__),n&&n.call(this,l),l&&l._registeredComponents&&l._registeredComponents.add(c)},r._ssrRegister=s):n&&(s=S?function(){n.call(this,(r.functional?this.parent:this).$root.$options.shadowRoot)}:n),s)if(r.functional){r._injectStyles=s;var g=r.render;r.render=function(w,p){return s.call(p),g(w,p)}}else{var u=r.beforeCreate;r.beforeCreate=u?[].concat(u,s):[s]}return{exports:a,options:r}}const m={inject:["validatePorts"],props:{section:{type:Object,required:!0}},data(){return{modeOptions:[["server",this.$t("Server")],["proxy",this.$t("Proxy")],["cmdline",this.$t("Command line")]]}}};var f=function(){var e=this,i=e._self._c;return i("vuci-form",{attrs:{config:"emailrelay",editing:""},scopedSlots:e._u([{key:"default",fn:function({uciData:o,editableSection:n}){return[i("vuci-named-section",{attrs:{name:n.id,title:e.$t("Email Relay %s configuration").format(e.section.id),help:e.$t("This section is used to configure the settings of the %s instance.").format(e.section.id),endpoints:[{endpoint:"email_relay/config"}],"uci-data":o,"data-key":"emailrelay"},scopedSlots:e._u([{key:"default",fn:function({s:t}){return[i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Enable"),help:e.$t("Enable instance."),name:"enabled"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,name:"mode",label:e.$t("Mode"),help:e.$t("Instance mode."),options:e.modeOptions}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"smtp_port",label:e.$t("SMTP port"),placeholder:"25",rules:["uinteger","range(1,65535)",e.validatePorts],required:"",help:e.$t("SMTP Port to listen incoming connections."),depend:t.mode!=="cmdline"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"pop_port",label:e.$t("POP port"),placeholder:"110",rules:["uinteger","range(1,65535)",e.validatePorts],required:"",help:e.$t("POP Port to listen incoming connections."),depend:t.mode==="server"}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Remote clients"),help:e.$t("To allow connections from anywhere. By default only local allowed."),name:"remote_clients",depend:t.mode!=="cmdline"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"address_verifier",label:e.$t("Address verifier"),help:e.$t("Runs the specified external program to verify a message recipient's e-mail address."),depend:t.mode!=="cmdline"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"domain",label:e.$t("Domain"),rules:"hostname",placeholder:"smtp.example.com",help:e.$t("Specifies the network name that is used in SMTP EHLO. The default is derived from a DNS lookup of the local hostname."),depend:t.mode!=="cmdline"}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Anonymous"),help:e.$t("Disables the server's SMTP VRFY command."),name:"anonymous",depend:t.mode!=="cmdline"}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Server TLS"),help:e.$t("Enables TLS for incoming SMTP and POP connections."),name:"server_tls",depend:t.mode!=="cmdline"}}),i("vuci-form-item-upload",{attrs:{"uci-section":t,name:"server_tls_certificate",label:e.$t("TLS certificate"),help:e.$t("Specifies a PEM-format file containing a X.509 certificate and private key."),depend:t.mode!=="cmdline"&&t.server_tls==="1","max-size":"16MB",required:""}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("SMTP authentication"),help:e.$t("Enables SMTP server authentication of remote SMTP clients."),name:"server_auth",depend:t.mode!=="cmdline"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"server_username",label:e.$t("SMTP Username"),help:e.$t("Username for authentication with the SMTP server."),depend:t.mode!=="cmdline"&&t.server_auth==="1",rules:"credentials_validate",maxlength:"512",required:""}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"server_password",label:e.$t("SMTP Password"),help:e.$t("Password for authentication with the SMTP server."),depend:t.mode!=="cmdline"&&t.server_auth==="1",rules:"credentials_validate",maxlength:"512",password:"",required:""}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"pop_username",label:e.$t("POP Username"),help:e.$t("Username for authentication with the POP server."),depend:t.mode==="server",rules:"credentials_validate",maxlength:"512",required:""}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"pop_password",label:e.$t("POP Password"),help:e.$t("Password for authentication with the POP server."),depend:t.mode==="server",rules:"credentials_validate",maxlength:"512",password:"",required:""}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"smarthost",label:e.$t("Smarthost"),rules:"hostipport",required:"",help:e.$t("Specify the SMTP to forward emails."),depend:t.mode==="proxy"}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Client TLS"),help:e.$t("Enables negotiated TLS for outgoing SMTP connections."),name:"client_tls",depend:t.mode==="proxy"}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Client authentication"),help:e.$t("Enables SMTP client authentication with the remote server."),name:"client_auth",depend:t.mode==="proxy"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"client_username",label:e.$t("Username"),help:e.$t("Username for authentication with the remote server."),depend:t.mode==="proxy"&&t.client_auth==="1",rules:"credentials_validate",maxlength:"512",required:""}}),i("vuci-form-item-input",{attrs:{"uci-section":t,name:"client_password",label:e.$t("Password"),help:e.$t("Password for authentication with the remote server."),depend:t.mode==="proxy"&&t.client_auth==="1",rules:"credentials_validate",maxlength:"512",password:"",required:""}}),i("vuci-form-item-list",{attrs:{"uci-section":t,name:"extra_cmdline",label:e.$t("Extra command line"),help:e.$t("Extra command line options."),rules:"fieldvalidation('^[a-zA-Z0-9!@#$%&*+-/=?^_`{|}:~. ]+$')",depend:t.mode==="cmdline"}})]}}],null,!0)})]}}])})},h=[],v=d(m,f,h,!1,null,null,null,null);const _=v.exports,$={provide(){return{validatePorts:this.validatePorts}},data(){return{editModal:_,emailColumns:[{name:"name",label:this.$t("Instance name"),help:this.$t("Name of the instace.")},{name:"mode",label:this.$t("Mode"),help:this.$t("Instance mode.")},{name:"enabled"}],modeOptions:[["server",this.$t("Server")],["proxy",this.$t("Proxy")],["cmdline",this.$t("Command line")]],formData:{}}},methods:{displayMode(a){return this.modeOptions[this.modeOptions.findIndex(e=>e[0]===a)][1]},validatePorts(a,e){const i=e.uciSection;return this.formData.emailrelay.some(o=>o.id!==i.id&&(o.smtp_port===a||o.pop_port===a))?{isValid:!1,message:this.$t("Port is used in another instance")}:i.smtp_port===i.pop_port?{isValid:!1,message:this.$t("Port is used in another field")}:{isValid:!0}},validateEnable(a){const e=a.uciSection;e.mode!=="cmdline"&&!e.smtp_port&&!e.pop_port&&(a.model=a.initialValue,this.$message.error(this.$t("Instance cannot be enabled without SMTP and POP ports")))}}};var y=function(){var e=this,i=e._self._c;return i("vuci-form",{attrs:{config:"emailrelay"},scopedSlots:e._u([{key:"default",fn:function({uciData:o}){return[i("vuci-typed-section",{attrs:{title:e.$t("Email Relay Configuration"),help:e.$t("This section displays Email relays that are currently configured on the router."),columns:e.emailColumns,"edit-form":e.editModal,"uci-data":o,endpoints:[{endpoint:"email_relay/config",sectionFilter:n=>n}],"data-key":"emailrelay",addremove:""},scopedSlots:e._u([{key:"name",fn:function({s:n}){return[i("vuci-form-item-dummy",{attrs:{"uci-section":n,name:"id"}})]}},{key:"mode",fn:function({s:n}){return[i("vuci-form-item-dummy",{attrs:{"uci-section":n,name:"mode","display-value":e.displayMode}})]}},{key:"enabled",fn:function({s:n}){return[i("vuci-form-item-switch",{attrs:{"uci-section":n,name:"enabled"},on:{change:e.validateEnable}})]}},{key:"addForm",fn:function({addModel:n}){return[i("tlt-form-item-input",{attrs:{label:e.$t("New instance name"),prop:"id",required:"",rules:"uciname",maxlength:"15",help:e.$t("Name of the new Email Relay instance.")},model:{value:n.id,callback:function(t){e.$set(n,"id",t)},expression:"addModel.id"}}),i("tlt-form-item-select",{attrs:{label:e.$t("Mode"),prop:"mode",help:e.$t("Instance mode."),options:e.modeOptions},model:{value:n.mode,callback:function(t){e.$set(n,"mode",t)},expression:"addModel.mode"}})]}}],null,!0)})]}}]),model:{value:e.formData,callback:function(o){e.formData=o},expression:"formData"}})},P=[],b=d($,y,P,!1,null,null,null,null);return b.exports});
