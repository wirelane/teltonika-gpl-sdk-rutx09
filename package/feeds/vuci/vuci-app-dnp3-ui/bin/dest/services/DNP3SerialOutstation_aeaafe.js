(function(l,d){typeof exports=="object"&&typeof module<"u"?module.exports=d():typeof define=="function"&&define.amd?define(d):(l=typeof globalThis<"u"?globalThis:l||self,l["services/DNP3SerialOutstation_js"]=d())})(this,function(){"use strict";function l(a,e,i,r,t,c,u,y){var s=typeof a=="function"?a.options:a;e&&(s.render=e,s.staticRenderFns=i,s._compiled=!0),r&&(s.functional=!0),c&&(s._scopeId="data-v-"+c);var o;if(u?(o=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__<"u"&&(n=__VUE_SSR_CONTEXT__),t&&t.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(u)},s._ssrRegister=o):t&&(o=y?function(){t.call(this,(s.functional?this.parent:this).$root.$options.shadowRoot)}:t),o)if(s.functional){s._injectStyles=o;var g=s.render;s.render=function(S,f){return o.call(f),g(S,f)}}else{var m=s.beforeCreate;s.beforeCreate=m?[].concat(m,o):[o]}return{exports:a,options:s}}const d={inject:["formOptions"],props:{section:{type:Object,required:!0}},data(){return{formData:{},initialDevice:""}},computed:{device(){return this.$serial.deviceDisplayValue(this.section.device)},serialOptions(){return this.$serial.filterOptions(this.formOptions().serial,this.section.device,this.section,"external")},usedDevice(){return this.formOptions().status.find(a=>a.name===this.section.device&&a.is_used==="1")},noDevice(){return this.$serial.checkForExternalDevice(this.formOptions().device,{device:this.initialDevice})}},methods:{loadInitial(){this.initialDevice=this.section.device},validateAddress(a){return this.formData.outstation.some(i=>i.device===this.section.device&&i.local_addr===a&&i.id!==this.section.id)?{isValid:!1,message:this.$t("Current local address is already set in the same layer.")}:{isValid:!0}},returnErrorMessage(a){return this.$serial.handleExternalDeviceErrors(a)},validate(){return this.$serial.validateBeforeSave(this.formOptions().status,this.formData.outstation,"DNP3 Serial Outstation")}}};var v=function(){var e=this,i=e._self._c;return i("vuci-form",{attrs:{editing:"","after-load":e.loadInitial,"before-save":e.validate},scopedSlots:e._u([{key:"default",fn:function({uciData:r}){return[i("vuci-named-section",{attrs:{"uci-data":r,name:e.section.id,"data-key":"outstation",endpoints:[{endpoint:"dnp3/serial_outstation/config"}],title:e.$t("%s device DNP3 outstation configuration").format(e.device),help:e.$t("Settings for DNP3 outstation configuration"),"error-handlers":{edit:e.returnErrorMessage}},scopedSlots:e._u([{key:"default",fn:function({s:t}){return[i("vuci-form-item-switch",{attrs:{"uci-section":t,name:"enabled",label:e.$t("Enable"),rawhtml:"",help:e.$t("Enable service"),readonly:e.$serial.validateServices(e.formOptions().status,t,"DNP3 Serial Outstation")&&t.enabled==="0"}}),e.noDevice?i("tlt-inline-message",{attrs:{id:"device-not-available",type:"warning",message:e.$serial.returnDisconnectedDeviceError(e.initialDevice)}}):e._e(),e.$serial.validateServices(e.formOptions().status,t,"DNP3 Serial Outstation")&&t.enabled==="0"?i("tlt-inline-message",{attrs:{id:"device-service-enabled",type:"warning"}},[e._v(" "+e._s(e.$t("Device is already enabled in %s service, disable it").format(e.usedDevice.service))+" "),i("router-link",{attrs:{to:e.$serial.returnPath(e.usedDevice.service),"test-id":"device-service-enabled-link"}},[e._v(" "+e._s(e.$t("here"))+" ")])],1):e._e(),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Name"),help:e.$t("Name of DNP3 outstation configuration"),maxlength:"200",name:"name"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Device"),help:e.$t("Which serial port will be used for serial communication"),name:"device",options:e.formOptions().device}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Baud rate"),help:e.$t("Select supported baud rate"),name:"baudrate",options:e.serialOptions.baudRate,initial:"9600"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Data bits"),help:e.$t("Select how many bits will be used for character"),name:"databits",options:e.serialOptions.dataBits,initial:"8"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Stop bits"),help:e.$t("Select how many stop bits will be used to detect the end of character"),name:"stopbits",options:e.serialOptions.stopBits,initial:"1"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Parity"),help:e.$t("Select what kind of parity bit to use for error detection"),name:"parity",initial:"none",options:e.serialOptions.parity}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Flow control"),help:e.$t("Select what kind of characters to use for flow control"),name:"flowcontrol",initial:"none",options:e.serialOptions.flowControl}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Local Address"),help:e.$t("Outstation Link-Layer Address"),name:"local_addr",rules:["irange(0,65519)",e.validateAddress],initial:"1",placeholder:"1"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Remote Address"),help:e.$t("Client Link-Layer address"),name:"remote_addr",rules:"irange(0,65519)",initial:"2",placeholder:"2"}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Unsolicited enabled"),help:e.$t("Enable the transmission of unsolicited messages"),name:"unsolicited_enabled"}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Full Duplex"),help:e.$t("Check to enable rs485 Full-Duplex"),name:"full_duplex_enabled",depend:t.device==="/dev/rs485"}})]}}],null,!0)})]}}]),model:{value:e.formData,callback:function(r){e.formData=r},expression:"formData"}})},p=[],h=l(d,v,p,!1,null,null,null,null);const $=h.exports,b={provide(){return{formOptions:this.getFormOptions}},data(){return{outstationColumns:[{name:"name",label:this.$t("Name")},{name:"device",label:this.$t("Device")},{name:"enabled",label:this.$t("Enabled")}],formOptions:{serial:[],device:[],status:[]},editModal:$,formData:{}}},computed:{devices(){return this.$serial.filterDevices(this.formOptions.serial)}},methods:{noDevice(a){return this.$serial.checkForExternalDevice(this.devices,a)},getFormOptions(){return this.formOptions},displayDevices(a){return this.$serial.deviceDisplayValue(a)},deviceUnavailable(){return this.$t("Device is unavailable")},returnErrorMessage(a){return this.$serial.handleExternalDeviceErrors(a)},loadData(){return this.$axios.bulkGet(["/api/system/device/status","/api/serial/status"]).then(([a,e])=>{this.formOptions.serial=a.success&&a.data.board.serial?a.data.board.serial:[],this.formOptions.device=this.devices,this.formOptions.status=e.success?e.data:[],a.success||this.$message.error(this.$t("Failed to load serial data")),e.success||this.$message.error(this.$t("Failed to load rs serial status"))}).catch(()=>{this.$message.error(this.$t("An unexpected error occurred"))})},validate(){return this.$serial.validateBeforeSave(this.formOptions.status,this.formData.outstation,"DNP3 Serial Outstation")}}};var _=function(){var e=this,i=e._self._c;return i("vuci-form",{attrs:{"after-load":e.loadData,"before-save":e.validate},scopedSlots:e._u([{key:"default",fn:function({uciData:r}){return[i("vuci-typed-section",{attrs:{type:"dnp3_serial_outstation",title:e.$t("DNP3 Serial Outstation Configuration"),help:e.$t("This section displays DNP3 serial outstation instances currently existing on the router."),columns:e.outstationColumns,"edit-form":e.editModal,"uci-data":r,endpoints:[{endpoint:"dnp3/serial_outstation/config"}],"data-key":"outstation","error-handlers":{edit:e.returnErrorMessage,create:e.deviceUnavailable}},scopedSlots:e._u([{key:"name",fn:function({s:t}){return[i("vuci-form-item-dummy",{attrs:{"uci-section":t,name:"name"}})]}},{key:"device",fn:function({s:t}){return[i("vuci-form-item-dummy",{attrs:{"uci-section":t,name:"device","display-value":e.displayDevices}})]}},{key:"enabled",fn:function({s:t}){return[i("tlt-hint",{attrs:{rawhtml:"",hints:(e.$serial.validateServices(e.formOptions.status,t,"DNP3 Serial Outstation")||e.noDevice(t))&&(t.enabled==="0"||!t.enabled)?[{info:e.$serial.filterError(e.formOptions.status,t,e.devices)}]:[]}},[i("vuci-form-item-switch",{attrs:{"uci-section":t,name:"enabled",readonly:(e.$serial.validateServices(e.formOptions.status,t,"DNP3 Serial Outstation")||e.noDevice(t))&&(t.enabled==="0"||!t.enabled)}})],1)]}},{key:"addForm",fn:function({addModel:t}){return[i("tlt-form-item-input",{attrs:{label:e.$t("New configuration name"),prop:"name",maxlength:"200",help:e.$t("Name of the new DNP3 serial outstation configuration. Used for easier configurations management purpose only")},model:{value:t.name,callback:function(c){e.$set(t,"name",c)},expression:"addModel['name']"}}),i("tlt-form-item-select",{attrs:{label:e.$t("Device name"),prop:"device",options:e.devices,required:"",placeholder:e.$t("Serial device is unavailable"),help:e.$t("Device that is bound to the created section. Routers serial ports or USB port with a serial adapter attached can be used.")},model:{value:t.device,callback:function(c){e.$set(t,"device",c)},expression:"addModel['device']"}})]}}],null,!0)})]}}]),model:{value:e.formData,callback:function(r){e.formData=r},expression:"formData"}})},D=[],O=l(b,_,D,!1,null,null,null,null);return O.exports});
