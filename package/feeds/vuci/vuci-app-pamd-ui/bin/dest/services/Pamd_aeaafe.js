(function(u,l){typeof exports=="object"&&typeof module<"u"?module.exports=l():typeof define=="function"&&define.amd?define(l):(u=typeof globalThis<"u"?globalThis:u||self,u["services/Pamd_js"]=l())})(this,function(){"use strict";function u(r,e,i,d,s,t,c,O){var n=typeof r=="function"?r.options:r;e&&(n.render=e,n.staticRenderFns=i,n._compiled=!0),d&&(n.functional=!0),t&&(n._scopeId="data-v-"+t);var a;if(c?(a=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),s&&s.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(c)},n._ssrRegister=a):s&&(a=O?function(){s.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:s),a)if(n.functional){n._injectStyles=a;var M=n.render;n.render=function(g,p){return a.call(p),M(g,p)}}else{var m=n.beforeCreate;n.beforeCreate=m?[].concat(m,a):[a]}return{exports:r,options:n}}const l={inject:["formOptions"],props:{section:{type:Object,required:!0}},data(){return{typeOptions:[["required",this.$t("Required")],["requisite",this.$t("Requisite")],["sufficient",this.$t("Sufficient")],["optional",this.$t("Optional")]],modules:[["tacplus","TACACS+"],["radius_auth","RADIUS"],["unix",this.$t("Local")]],userList:[]}},computed:{filterModules(){return this.modules.filter(r=>this.formOptions().modules.includes(r[0]))},userOptions(){return this.userList.map(r=>[r.id,r.username])},selectedModuleName(){var r;return(r=this.modules.find(e=>e[0]===this.section.module))==null?void 0:r[1]},serverHint(){return this.$t("The IP address of the %s server").format(this.selectedModuleName)},portHint(){return this.$t("%s server authentication port").format(this.selectedModuleName)},secretHint(){let r=this.$t("%s server key");return this.section.module==="radius_auth"&&(r=this.$t("%s shared secret")),r.format(this.selectedModuleName)},secretName(){return this.section.module==="radius_auth"?this.$t("Secret"):this.$t("Key")}},methods:{loadUsers(){return this.$axios.get("/api/users/config").then(({data:r})=>{this.userList=r}).catch(()=>this.$message.error(this.$t("Failed to load user list")))}}};var f=function(){var e=this,i=e._self._c;return i("vuci-form",{attrs:{config:"pam;rpcd;dropbear",editing:"","after-load":e.loadUsers},scopedSlots:e._u([{key:"default",fn:function({uciData:d,editableSection:s}){return[i("vuci-named-section",{attrs:{endpoints:[{endpoint:"access_control/pam/config"}],name:s.id,title:e.$t("Modify PAM auth"),"uci-data":d,"data-key":"pamd"},scopedSlots:e._u([{key:"default",fn:function({s:t}){return[i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Enable"),help:e.$t("Turns the PAM authentication on or off."),name:"enabled",initial:"0"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Module"),help:e.$t("Specifies the PAM module that implements the service"),name:"module",options:e.filterModules}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Type"),help:e.$t("Determines the continuation or failure behavior for the module"),name:"type",options:e.typeOptions}}),i("vuci-form-item-switch",{attrs:{"uci-section":t,label:e.$t("Enable for all users"),help:e.$t("Turn on PAM authentication for all users."),name:"all_users",initial:"0",depend:t.service==="rpcd"}}),i("vuci-form-item-select",{attrs:{"uci-section":t,label:e.$t("Select users"),help:e.$t("Select users for PAM authentication"),name:"users",options:e.userOptions,multiple:"",depend:t.service==="rpcd"&&t.all_users==="0"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Server"),help:e.serverHint,name:"server",rules:"ipaddr",required:"",placeholder:"192.168.1.1",depend:t.module==="radius_auth"||t.module==="tacplus"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.secretName,help:e.secretHint,name:"secret",required:"",password:"",depend:t.module==="radius_auth"||t.module==="tacplus"}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Port"),help:e.portHint,name:"port",rules:"port",initial:"1812",depend:t.module==="radius_auth",required:""}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Port"),help:e.portHint,name:"port",rules:"port",initial:"49",depend:t.module==="tacplus",required:""}}),i("vuci-form-item-input",{attrs:{"uci-section":t,label:e.$t("Timeout"),help:e.$t("Timeout in seconds waiting for RADIUS server reply"),name:"timeout",required:"",rules:"range(3,10)",depend:t.module==="radius_auth",initial:"3"}})]}}],null,!0)})]}}])})},h=[],v=u(l,f,h,!1,null,null,null,null);const _=v.exports,$={provide(){return{formOptions:this.getFormOptions}},data(){return{pamColumns:[{name:"service",label:this.$t("Service")},{name:"module",label:this.$t("Module")},{name:"type",label:this.$t("Type")},{name:"enabled"}],editModal:_,serviceOptions:[["sshd",this.$t("SSH")],["rpcd",this.$t("WebUI")]],moduleList:{radius_auth:this.$t("Radius"),tacplus:this.$t("TACACS+"),unix:this.$t("Local")},serviceList:{sshd:this.$t("SSH"),rpcd:this.$t("WebUI")},typeList:{required:this.$t("Required"),requisite:this.$t("Requisite"),sufficient:this.$t("Sufficient"),optional:this.$t("Optional")}}},methods:{getFormOptions(){return this.formOptions},loadData(){return this.$axios.get("/api/access_control/pam/options").then(({data:{modules:r}})=>{this.formOptions={modules:r}}).catch(()=>{this.$message.error(this.$t("Failed to load modules"))})}}};var y=function(){var e=this,i=e._self._c;return i("vuci-form",{attrs:{config:"pam;dropbear;rpcd","after-load":e.loadData},scopedSlots:e._u([{key:"default",fn:function({uciData:d}){return[i("vuci-typed-section",{attrs:{type:"pam",title:e.$t("PAM auth"),columns:e.pamColumns,addremove:"","uci-data":d,"edit-form":e.editModal,endpoints:[{endpoint:"access_control/pam/config"}],"data-key":"pamd"},scopedSlots:e._u([{key:"service",fn:function({s}){return[i("vuci-form-item-dummy",{attrs:{name:"service","uci-section":s,"display-value":t=>e.serviceList[t]}})]}},{key:"module",fn:function({s}){return[i("vuci-form-item-dummy",{attrs:{name:"module","uci-section":s,"display-value":t=>e.moduleList[t]}})]}},{key:"type",fn:function({s}){return[i("vuci-form-item-dummy",{attrs:{name:"type","uci-section":s,"display-value":t=>e.typeList[t]}})]}},{key:"enabled",fn:function({s}){return[i("vuci-form-item-switch",{attrs:{name:"enabled","uci-section":s}})]}},{key:"addForm",fn:function({addModel:s}){return[i("tlt-form-item-select",{attrs:{label:e.$t("Service"),prop:"service",options:e.serviceOptions},model:{value:s.service,callback:function(t){e.$set(s,"service",t)},expression:"addModel.service"}})]}}],null,!0)})]}}])})},b=[],S=u($,y,b,!1,null,null,null,null);return S.exports});
