Index: mwan3-2.10.12/files/usr/share/15-mwan3
===================================================================
--- mwan3-2.10.12.orig/files/usr/share/15-mwan3
+++ mwan3-2.10.12/files/usr/share/15-mwan3
@@ -154,7 +154,7 @@ restart_openvpn() {
 				[ "$IFNAME" = "$active" ] && restart=1
 				;;
 			ifdown|disconnected)
-				[ "$IFNAME" != "$active" ] && restart=1
+				[ "$IFNAME" != "$active" ] && [ "$(uci -q get mwan3.${IFNAME}_member_mwan.metric)" -lt "$(uci -q get mwan3.${active}_member_mwan.metric)" ] && restart=1
 				;;
 		esac
 		if [ "$restart" = 1 ]; then
@@ -165,11 +165,37 @@ restart_openvpn() {
 	fi
 }
 
+restart_l2tp() {
+	local sid="$1"
+	local disabled proto active
+	local restart=0
+	config_get disabled "$sid" disabled
+	config_get proto "$sid" proto
+	active="$(cat /tmp/run/mwan3/active_wan)"
+	if [ "$MWAN3_STARTUP" != "init" ] && [ "$disabled" != "1" ] && [ "$proto" = "l2tp" ] && [ "$IFNAME" != "$sid" ]; then
+		case "$ACTION" in
+			ifup|connected)
+				[ "$IFNAME" = "$active" ] && restart=1
+				;;
+			ifdown|disconnected)
+				[ "$IFNAME" != "$active" ] && [ "$(uci -q get mwan3.${IFNAME}_member_mwan.metric)" -lt "$(uci -q get mwan3.${active}_member_mwan.metric)" ] && restart=1
+				;;
+		esac
+		if [ "$restart" = 1 ];then
+			{ sleep 3
+			logger -t mwan3 "l2tp interface $sid is restarting"
+			ifup "$sid"; } &
+		fi
+	fi
+}
+
 config_load ipsec
 config_foreach flush_conntrack connection
 ipsec_routes
 config_load openvpn
 config_foreach restart_openvpn openvpn
+config_load network
+config_foreach restart_l2tp interface
 config_load mwan3
 
 exit 0
